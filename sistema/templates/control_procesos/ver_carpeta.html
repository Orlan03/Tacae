{% extends "base.html" %}
{% block title %}ğŸ“‚ {{ carpeta.nombre }}{% endblock %}

{% block content %}
<div class="container">
    <h2>ğŸ“ {{ carpeta.nombre }}</h2>

    <!-- Mostrar solo subcarpetas -->
    <h3>ğŸ“‚ Subcarpetas</h3>
    <div class="grid-container">
        {% for subcarpeta in carpeta.subcarpetas.all %}
            <div class="folder-card">
                <a href="{% url 'carpetas:ver_carpeta' subcarpeta.id %}" class="folder-link">
                    ğŸ“ {{ subcarpeta.nombre }}
                </a>
            </div>
        {% empty %}
            <p>No hay subcarpetas en esta carpeta.</p>
        {% endfor %}
    </div>

    <!-- PROCESOS: Solo se muestran si la carpeta pertenece a "Procesos Pendientes" -->
    {% if carpeta.padre and carpeta.padre.nombre == "Procesos Pendientes" %}
    <div class="process-section">
        <h3>ğŸ“„ Procesos Registrados en {{ carpeta.nombre }}</h3>

        {% if carpeta.procesos.all %}
            <table class="table">
                <thead>
                    <tr>
                        <th>Proceso</th>
                        <th>Responsable</th>
                        <th>Fecha Cumplimiento</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    {% for proceso in carpeta.procesos.all %}
                        <tr>
                            <td>{{ proceso.proceso }}</td>
                            <td>{{ proceso.responsable }}</td>
                            <td>{{ proceso.fecha_cumplimiento|default:"-" }}</td>
                            <td>
                                <a href="#" class="btn btn-info btn-sm">Ver Detalles</a>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% else %}
            <p>No hay procesos registrados en esta carpeta.</p>
        {% endif %}

     

        <!-- BotÃ³n para registrar un nuevo proceso en esta subcarpeta -->
        <a href="{% url 'procesos:registrar_proceso' carpeta.id %}" class="btn btn-success">ğŸ“‹ Registrar Nuevo Proceso</a>
    {% endif %}

    <a href="{% url 'carpetas:listar_carpetas' %}" class="btn btn-secondary">â¬… Volver</a>
</div>

<style>
    .grid-container {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-top: 20px;
    }

    .folder-card {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 8px;
        text-align: center;
        box-shadow: 2px 2px 10px rgba(0,0,0,0.1);
    }

    .folder-link {
        font-size: 1.2rem;
        font-weight: bold;
        color: #0277bd;
        text-decoration: none;
    }

    .folder-link:hover {
        text-decoration: underline;
    }

    .table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
    }

    .table th, .table td {
        border: 1px solid #ddd;
        padding: 10px;
        text-align: left;
    }

    .table th {
        background-color: #f2f2f2;
    }
</style>
{% endblock %}
